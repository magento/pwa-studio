import configAggregator from '../configAggregator';

test('products config aggregator retrieves skus', () => {
    const node = document.createElement('div');

    node.innerHTML =
        '<div class="product-class" data-content-type="products" data-appearance="grid" data-element="main" style="text-align: right; border-style: solid; border-color: rgb(255, 0, 0); border-width: 10px; border-radius: 15px; margin: 20px; padding: 30px;"> <div class="block widget block-products-list grid"> <div class="block-content"> <!-- new_products_content_widget_grid--> <div class="products-grid grid"> <ol class="product-items widget-product-grid"> <li class="product-item"> <div class="product-item-info"> <a href="https://pagebuilder.test/overnight-duffle.html" class="product-item-photo"> <span class="product-image-container" style="width:240px;"> <span class="product-image-wrapper" style="padding-bottom: 125%;"> <img class="product-image-photo" src="https://pagebuilder.test/media/catalog/product/cache/69f87e6753657df3b7f8f490758c4b87/w/b/wb07-brown-0.jpg" max-width="240" max-height="300" alt="Overnight Duffle"></span> </span> </a> <div class="product-item-details"> <strong class="product-item-name"> <a title="Overnight Duffle" href="https://pagebuilder.test/overnight-duffle.html" class="product-item-link"> Overnight Duffle </a> </strong> <div class="product-reviews-summary short"> <div class="rating-summary"> <span class="label"><span>Rating:</span></span> <div class="rating-result" title="60%"> <span style="width:60%"><span>60%</span></span> </div> </div> <div class="reviews-actions"> <a class="action view" href="https://pagebuilder.test/overnight-duffle.html#reviews">3&nbsp;<span>Reviews</span></a> </div> </div> <div class="price-box price-final_price" data-role="priceBox" data-product-id="13" data-price-box="product-id-13"> <span class="price-container price-final_price tax weee"> <span id="old-price-13-widget-product-grid" data-price-amount="45" data-price-type="finalPrice" class="price-wrapper "><span class="price">$45.00</span></span> </span> </div> <div class="product-item-inner"> <div class="product-item-actions"> <div class="actions-primary"> <form data-role="tocart-form" data-product-sku="24-WB07" action="https://pagebuilder.test/checkout/cart/add/uenc/aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw%2C/product/13/" method="post"> <input type="hidden" name="product" value="13"> <input type="hidden" name="uenc" value="aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2NoZWNrb3V0L2NhcnQvYWRkL3VlbmMvYUhSMGNITTZMeTl3WVdkbFluVnBiR1JsY2k1MFpYTjBMMmR5WVhCb2NXdyUyQy9wcm9kdWN0LzEzLw,,"> <button type="submit" title="Add to Cart" class="action tocart primary"> <span>Add to Cart</span> </button> </form> </div> <div class="actions-secondary" data-role="add-to-links"> <a href="#" data-post="{&quot;action&quot;:&quot;https:\\/\\/pagebuilder.test\\/wishlist\\/index\\/add\\/&quot;,&quot;data&quot;:{&quot;product&quot;:13,&quot;uenc&quot;:&quot;aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw,&quot;}}" class="action towishlist" data-action="add-to-wishlist" title="Add to Wish List"> <span>Add to Wish List</span> </a> <a href="#" class="action tocompare" data-post="{&quot;action&quot;:&quot;https:\\/\\/pagebuilder.test\\/catalog\\/product_compare\\/add\\/&quot;,&quot;data&quot;:{&quot;product&quot;:&quot;13&quot;,&quot;uenc&quot;:&quot;aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw,&quot;}}" title="Add to Compare"> <span>Add to Compare</span> </a> </div> </div> </div> </div> </div> </li><li class="product-item"> <div class="product-item-info"> <a href="https://pagebuilder.test/driven-backpack.html" class="product-item-photo"> <span class="product-image-container" style="width:240px;"> <span class="product-image-wrapper" style="padding-bottom: 125%;"> <img class="product-image-photo" src="https://pagebuilder.test/media/catalog/product/cache/69f87e6753657df3b7f8f490758c4b87/w/b/wb03-purple-0.jpg" max-width="240" max-height="300" alt="Driven Backpack"></span> </span> </a> <div class="product-item-details"> <strong class="product-item-name"> <a title="Driven Backpack" href="https://pagebuilder.test/driven-backpack.html" class="product-item-link"> Driven Backpack </a> </strong> <div class="product-reviews-summary short"> <div class="rating-summary"> <span class="label"><span>Rating:</span></span> <div class="rating-result" title="90%"> <span style="width:90%"><span>90%</span></span> </div> </div> <div class="reviews-actions"> <a class="action view" href="https://pagebuilder.test/driven-backpack.html#reviews">2&nbsp;<span>Reviews</span></a> </div> </div> <div class="price-box price-final_price" data-role="priceBox" data-product-id="12" data-price-box="product-id-12"> <span class="price-container price-final_price tax weee"> <span id="old-price-12-widget-product-grid" data-price-amount="36" data-price-type="finalPrice" class="price-wrapper "><span class="price">$36.00</span></span> </span> </div> <div class="product-item-inner"> <div class="product-item-actions"> <div class="actions-primary"> <form data-role="tocart-form" data-product-sku="24-WB03" action="https://pagebuilder.test/checkout/cart/add/uenc/aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw%2C/product/12/" method="post"> <input type="hidden" name="product" value="12"> <input type="hidden" name="uenc" value="aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2NoZWNrb3V0L2NhcnQvYWRkL3VlbmMvYUhSMGNITTZMeTl3WVdkbFluVnBiR1JsY2k1MFpYTjBMMmR5WVhCb2NXdyUyQy9wcm9kdWN0LzEyLw,,"> <button type="submit" title="Add to Cart" class="action tocart primary"> <span>Add to Cart</span> </button> </form> </div> <div class="actions-secondary" data-role="add-to-links"> <a href="#" data-post="{&quot;action&quot;:&quot;https:\\/\\/pagebuilder.test\\/wishlist\\/index\\/add\\/&quot;,&quot;data&quot;:{&quot;product&quot;:12,&quot;uenc&quot;:&quot;aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw,&quot;}}" class="action towishlist" data-action="add-to-wishlist" title="Add to Wish List"> <span>Add to Wish List</span> </a> <a href="#" class="action tocompare" data-post="{&quot;action&quot;:&quot;https:\\/\\/pagebuilder.test\\/catalog\\/product_compare\\/add\\/&quot;,&quot;data&quot;:{&quot;product&quot;:&quot;12&quot;,&quot;uenc&quot;:&quot;aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw,&quot;}}" title="Add to Compare"> <span>Add to Compare</span> </a> </div> </div> </div> </div> </div> </li> </ol> </div> </div> </div> </div>';
    expect(
        configAggregator(node.childNodes[0], {
            appearance: 'grid'
        })
    ).toEqual(
        expect.objectContaining({
            pathNames: [
                'https://pagebuilder.test/overnight-duffle.html',
                'https://pagebuilder.test/driven-backpack.html'
            ]
        })
    );
});

test('products config aggregator retrieves carousel appearance settings', () => {
    const node = document.createElement('div');

    node.innerHTML =
        '<div class="product-class" data-content-type="products" data-appearance="carousel" data-autoplay="false" data-autoplay-speed="4000" data-infinite-loop="false" data-show-arrows="false" data-show-dots="true" data-carousel-mode="default" data-center-padding="90px" data-element="main" style="text-align: right; border-style: solid; border-color: rgb(255, 0, 0); border-width: 10px; border-radius: 15px; margin: 20px; padding: 30px;"> <ol class="product-items widget-product-grid"> <li class="product-item"> <div class="product-item-info"> <a href="https://pagebuilder.test/overnight-duffle.html" class="product-item-photo"> <span class="product-image-container" style="width:240px;"> <span class="product-image-wrapper" style="padding-bottom: 125%;"> <img class="product-image-photo" src="https://pagebuilder.test/media/catalog/product/cache/69f87e6753657df3b7f8f490758c4b87/w/b/wb07-brown-0.jpg" max-width="240" max-height="300" alt="Overnight Duffle"> </span> </span> </a> <div class="product-item-details"> <strong class="product-item-name"> <a title="Overnight Duffle" href="https://pagebuilder.test/overnight-duffle.html" class="product-item-link"> Overnight Duffle </a> </strong> <div class="product-reviews-summary short"> <div class="rating-summary"> <span class="label"> <span>Rating:</span> </span> <div class="rating-result" title="60%"> <span style="width:60%"><span>60%</span></span> </div> </div> <div class="reviews-actions"> <a class="action view" href="https://pagebuilder.test/overnight-duffle.html#reviews">3&nbsp;<span>Reviews</span></a> </div> </div> <div class="price-box price-final_price" data-role="priceBox" data-product-id="13" data-price-box="product-id-13"> <span class="price-container price-final_price tax weee"> <span id="old-price-13-widget-product-grid" data-price-amount="45" data-price-type="finalPrice" class="price-wrapper "><span class="price">$45.00</span></span> </span> </div> <div class="product-item-inner"> <div class="product-item-actions"> <div class="actions-primary"> <form data-role="tocart-form" data-product-sku="24-WB07" action="https://pagebuilder.test/checkout/cart/add/uenc/aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw%2C/product/13/" method="post"> <input type="hidden" name="product" value="13"> <input type="hidden" name="uenc" value="aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2NoZWNrb3V0L2NhcnQvYWRkL3VlbmMvYUhSMGNITTZMeTl3WVdkbFluVnBiR1JsY2k1MFpYTjBMMmR5WVhCb2NXdyUyQy9wcm9kdWN0LzEzLw,,"> <button type="submit" title="Add to Cart" class="action tocart primary"> <span>Add to Cart</span> </button> </form> </div> <div class="actions-secondary" data-role="add-to-links"> <a href="#" data-post="{&quot;action&quot;:&quot;https:\\/\\/pagebuilder.test\\/wishlist\\/index\\/add\\/&quot;,&quot;data&quot;:{&quot;product&quot;:13,&quot;uenc&quot;:&quot;aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw,&quot;}}" class="action towishlist" data-action="add-to-wishlist" title="Add to Wish List"> <span>Add to Wish List</span> </a> <a href="#" class="action tocompare" data-post="{&quot;action&quot;:&quot;https:\\/\\/pagebuilder.test\\/catalog\\/product_compare\\/add\\/&quot;,&quot;data&quot;:{&quot;product&quot;:&quot;13&quot;,&quot;uenc&quot;:&quot;aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw,&quot;}}" title="Add to Compare"> <span>Add to Compare</span> </a> </div> </div> </div> </div> </div> </li><li class="product-item"> <div class="product-item-info"> <a href="https://pagebuilder.test/driven-backpack.html" class="product-item-photo"> <span class="product-image-container" style="width:240px;"> <span class="product-image-wrapper" style="padding-bottom: 125%;"> <img class="product-image-photo" src="https://pagebuilder.test/media/catalog/product/cache/69f87e6753657df3b7f8f490758c4b87/w/b/wb03-purple-0.jpg" max-width="240" max-height="300" alt="Driven Backpack"></span> </span> </a> <div class="product-item-details"> <strong class="product-item-name"> <a title="Driven Backpack" href="https://pagebuilder.test/driven-backpack.html" class="product-item-link"> Driven Backpack </a> </strong> <div class="product-reviews-summary short"> <div class="rating-summary"> <span class="label"><span>Rating:</span></span> <div class="rating-result" title="90%"> <span style="width:90%"><span>90%</span></span> </div> </div> <div class="reviews-actions"> <a class="action view" href="https://pagebuilder.test/driven-backpack.html#reviews">2&nbsp;<span>Reviews</span></a> </div> </div> <div class="price-box price-final_price" data-role="priceBox" data-product-id="12" data-price-box="product-id-12"> <span class="price-container price-final_price tax weee"> <span id="old-price-12-widget-product-grid" data-price-amount="36" data-price-type="finalPrice" class="price-wrapper "><span class="price">$36.00</span></span> </span> </div> <div class="product-item-inner"> <div class="product-item-actions"> <div class="actions-primary"> <form data-role="tocart-form" data-product-sku="24-WB03" action="https://pagebuilder.test/checkout/cart/add/uenc/aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw%2C/product/12/" method="post"> <input type="hidden" name="product" value="12"> <input type="hidden" name="uenc" value="aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2NoZWNrb3V0L2NhcnQvYWRkL3VlbmMvYUhSMGNITTZMeTl3WVdkbFluVnBiR1JsY2k1MFpYTjBMMmR5WVhCb2NXdyUyQy9wcm9kdWN0LzEyLw,,"> <button type="submit" title="Add to Cart" class="action tocart primary"> <span>Add to Cart</span> </button> </form> </div> <div class="actions-secondary" data-role="add-to-links"> <a href="#" data-post="{&quot;action&quot;:&quot;https:\\/\\/pagebuilder.test\\/wishlist\\/index\\/add\\/&quot;,&quot;data&quot;:{&quot;product&quot;:12,&quot;uenc&quot;:&quot;aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw,&quot;}}" class="action towishlist" data-action="add-to-wishlist" title="Add to Wish List"> <span>Add to Wish List</span> </a> <a href="#" class="action tocompare" data-post="{&quot;action&quot;:&quot;https:\\/\\/pagebuilder.test\\/catalog\\/product_compare\\/add\\/&quot;,&quot;data&quot;:{&quot;product&quot;:&quot;12&quot;,&quot;uenc&quot;:&quot;aHR0cHM6Ly9wYWdlYnVpbGRlci50ZXN0L2dyYXBocWw,&quot;}}" title="Add to Compare"> <span>Add to Compare</span> </a> </div> </div> </div> </div> </div> </li> </ol> </div>';
    expect(
        configAggregator(node.childNodes[0], {
            appearance: 'carousel'
        })
    ).toEqual(
        expect.objectContaining({
            autoplay: false,
            autoplaySpeed: 4000,
            infinite: false,
            arrows: false,
            dots: true,
            carouselMode: 'default',
            centerPadding: '90px'
        })
    );
});
